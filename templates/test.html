{% extends "base.html" %}
{% block title %}Cuestionario de 60 ítems{% endblock %}

{% block content %}
<h1>Big Five - Cuestionario de 60 ítems</h1>
<p class="muted">1 = Muy en desacuerdo | 5 = Muy de acuerdo</p>

<form method="post" action="{{ url_for('test') }}" class="card" style="padding:16px;">
  <div class="row" style="gap:12px; align-items:center; margin-bottom:22px;">
    <label>Nombre o apodo
      <input type="text" name="nickname" value="{{ (prev.nickname if prev) or '' }}" placeholder="Tu nombre">
    </label>
    <label>Email (opcional)
      <input type="email" name="email" value="{{ (prev.email if prev) or '' }}" placeholder="tu@correo.com">
    </label>
  </div>

  {# >>> AQUÍ ESTÁ EL BUCLE CORRECTO <<< #}
  {% for item in spec['items'] %}
    <div class="row" style="margin-bottom:28px;">  {# doble espacio entre preguntas #}
      <div class="qtext"><strong>{{ item.id }}.</strong> {{ item.text }}</div>
      <div class="scale">
        {% for n in range(spec.scale.min, spec.scale.max + 1) %}
          <label>
            <input
              type="radio"
              name="q{{ item.id }}"
              value="{{ n }}"
              {% if not prev %}required{% endif %}
              {% if prev and prev.get('q' ~ item.id) == n|string %}checked{% endif %}
            >
            {{ n }}
          </label>
        {% endfor %}
      </div>
    </div>
  {% endfor %}

  <button class="btn" type="submit">Enviar</button>

  <p class="muted" style="margin-top:16px;">
    © 2025 Big5-60p · Escala: {{ spec.scale.min }} = Muy en desacuerdo | {{ spec.scale.max }} = Muy de acuerdo
  </p>
</form>
{% endblock %}
